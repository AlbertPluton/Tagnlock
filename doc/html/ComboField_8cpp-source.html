<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Project: /home/bart/DMS/src/Category/ComboField.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>/home/bart/DMS/src/Category/ComboField.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">//  Author: A.L. Hertog</span>
<a name="l00003"></a>00003 <span class="comment">//  Date: 26 August 2008</span>
<a name="l00004"></a>00004 <span class="comment">//  License: GPL</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 <span class="comment">//</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include "ComboField.h"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include "FieldException.h"</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00015"></a>00015 <span class="keyword">using namespace </span>std;
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00018"></a>00018 
<a name="l00019"></a><a class="code" href="classComboField.html#d5c1f6c8351ac179fb15b3300d67f9ed">00019</a> <a class="code" href="classComboField.html#d5c1f6c8351ac179fb15b3300d67f9ed" title="The constructor.">ComboField::ComboField</a>( <span class="keywordtype">string</span> fieldLabel, <span class="keywordtype">bool</span> fieldRequired, <span class="keywordtype">bool</span> fieldReset, vector&lt;string&gt; * fieldCombo, ComboType fieldType ) : <a class="code" href="classField.html" title="A class which defines the basic information about a categorisation field.">Field</a>( fieldLabel, fieldRequired, fieldReset)
<a name="l00020"></a>00020 {
<a name="l00021"></a>00021   type = fieldType;
<a name="l00022"></a>00022   combo = fieldCombo;
<a name="l00023"></a>00023 }
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="classComboField.html#d55a81b2aba5c27aad8159999cb773d7">00029</a> <a class="code" href="classComboField.html#d5c1f6c8351ac179fb15b3300d67f9ed" title="The constructor.">ComboField::ComboField</a>( vector&lt;string&gt; * description )
<a name="l00030"></a>00030 {
<a name="l00031"></a>00031   <span class="keywordtype">string</span> str;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i&lt;(int)description-&gt;size(); i++)
<a name="l00034"></a>00034   {
<a name="l00035"></a>00035     str = description-&gt;at(i);
<a name="l00036"></a>00036     
<a name="l00037"></a>00037     <span class="keywordflow">if</span>( str.compare( 0, 6, <span class="stringliteral">"Type: "</span>) == 0 ) <span class="comment">//-------------------------------------</span>
<a name="l00038"></a>00038     {
<a name="l00039"></a>00039       str.erase(0, 6);
<a name="l00040"></a>00040       
<a name="l00041"></a>00041       <span class="comment">// Set the ComboType to the correct value       TODO nicely implement the use of the enumerator so it can be used without the need to exend this if else statement for each new combo type.</span>
<a name="l00042"></a>00042       <span class="keywordflow">if</span>( str.compare( <span class="stringliteral">"Combo"</span> ) == 0 ) type = Combo;
<a name="l00043"></a>00043       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( str.compare( <span class="stringliteral">"ComboEntry"</span> ) == 0 ) type = ComboEntry; 
<a name="l00044"></a>00044       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( str.compare( <span class="stringliteral">"ComboRadio"</span> ) == 0 ) type = ComboRadio; 
<a name="l00045"></a>00045       <span class="keywordflow">else</span>
<a name="l00046"></a>00046       { 
<a name="l00047"></a>00047         <span class="keywordflow">throw</span> <a class="code" href="classFieldException.html" title="A class which defines exceptions which can occur during operations in the field class...">FieldException</a>( 2, <span class="stringliteral">"UNKONWN"</span>, <span class="stringliteral">"UNKNOWN"</span>, <span class="stringliteral">"Input string was: "</span> + description-&gt;at(i) + <span class="stringliteral">"\n"</span>  ); <span class="comment">// throw Error: unknown combo type</span>
<a name="l00048"></a>00048       }
<a name="l00049"></a>00049       
<a name="l00050"></a>00050     }
<a name="l00051"></a>00051     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( str.compare( 0, 7, <span class="stringliteral">"Label: "</span>) == 0 )   <span class="comment">// ------------------------------</span>
<a name="l00052"></a>00052     {
<a name="l00053"></a>00053       str.erase(0, 7);
<a name="l00054"></a>00054       this-&gt;<a class="code" href="classField.html#0e2afe6cd1d689d3ac4ac12769567795" title="A set function for label.">setLabel</a>( str );
<a name="l00055"></a>00055     }
<a name="l00056"></a>00056     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( str.compare( 0, 10, <span class="stringliteral">"Required: "</span>) == 0 ) <span class="comment">//---------------------------</span>
<a name="l00057"></a>00057     {
<a name="l00058"></a>00058       <span class="comment">// Get the substring of str which should contain true or false.</span>
<a name="l00059"></a>00059       <span class="comment">// Convert it to a boolean, this function can throw a FieldException.</span>
<a name="l00060"></a>00060       <span class="comment">// Assign the boolean to required.</span>
<a name="l00061"></a>00061       <span class="keywordflow">try</span> { this-&gt;<a class="code" href="classField.html#2a5603452c9476b0c4949a398c79e6fb" title="A set function for required .">setRequired</a>( this-&gt;<a class="code" href="classField.html#954bee69f37578f92746c6efc5b59e2e" title="A function to convert strings to booleans.">stringToBool</a>( str.substr(10, 5) ) ); }
<a name="l00062"></a>00062       <span class="keywordflow">catch</span>(  <a class="code" href="classFieldException.html" title="A class which defines exceptions which can occur during operations in the field class...">FieldException</a>&amp; e ) 
<a name="l00063"></a>00063       {
<a name="l00064"></a>00064         <span class="comment">// Add information to the exception to be able to trace its origin. </span>
<a name="l00065"></a>00065         e.<a class="code" href="classFieldException.html#e2b9df8eaf68aacc9dcb838e8ca2e772" title="Set function for the field type.">setFieldType</a>( this-&gt;<a class="code" href="classComboField.html#82409aa936e0e1a102b2b10bbb8328b2" title="Get function.">getType</a>() );
<a name="l00066"></a>00066         e.<a class="code" href="classFieldException.html#6c387b3c9b3440cc8f34cba72e498dbd" title="Set function for the field label.">setFieldLabel</a>( this-&gt;<a class="code" href="classField.html#515aa3274bfaf8cde85a2f6debabfbca" title="A function which returns the field type.">getLabel</a>() );
<a name="l00067"></a>00067         e.<a class="code" href="classFieldException.html#8e24d3f80421bd692dba856fceaeace2" title="Add additional information.">addInfo</a>( <span class="stringliteral">"Input string was:"</span> + str + <span class="stringliteral">"\n"</span> );
<a name="l00068"></a>00068         <span class="keywordflow">throw</span>;
<a name="l00069"></a>00069       }     
<a name="l00070"></a>00070       <span class="keywordflow">catch</span>(  exception&amp; e ) { <span class="keywordflow">throw</span>; } 
<a name="l00071"></a>00071     }
<a name="l00072"></a>00072     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( str.compare( 0, 7, <span class="stringliteral">"Reset: "</span>) == 0 ) <span class="comment">//-------------------------------</span>
<a name="l00073"></a>00073     {
<a name="l00074"></a>00074       <span class="comment">// The same as above but now not for required but for reset.</span>
<a name="l00075"></a>00075       <span class="keywordflow">try</span> { this-&gt;<a class="code" href="classField.html#c5a55a2401c627d371cbe96ae7f4d7e3" title="A set function for reset.">setReset</a>( this-&gt;<a class="code" href="classField.html#954bee69f37578f92746c6efc5b59e2e" title="A function to convert strings to booleans.">stringToBool</a>( str.substr(7, 5) ) ); }
<a name="l00076"></a>00076       <span class="keywordflow">catch</span>(  <a class="code" href="classFieldException.html" title="A class which defines exceptions which can occur during operations in the field class...">FieldException</a>&amp; e ) 
<a name="l00077"></a>00077       {
<a name="l00078"></a>00078         <span class="comment">// Add information to the exception to be able to trace its origin. </span>
<a name="l00079"></a>00079         e.<a class="code" href="classFieldException.html#e2b9df8eaf68aacc9dcb838e8ca2e772" title="Set function for the field type.">setFieldType</a>( this-&gt;<a class="code" href="classComboField.html#82409aa936e0e1a102b2b10bbb8328b2" title="Get function.">getType</a>() );
<a name="l00080"></a>00080         e.<a class="code" href="classFieldException.html#6c387b3c9b3440cc8f34cba72e498dbd" title="Set function for the field label.">setFieldLabel</a>( this-&gt;<a class="code" href="classField.html#515aa3274bfaf8cde85a2f6debabfbca" title="A function which returns the field type.">getLabel</a>() );
<a name="l00081"></a>00081         e.<a class="code" href="classFieldException.html#8e24d3f80421bd692dba856fceaeace2" title="Add additional information.">addInfo</a>( <span class="stringliteral">"Input string was:"</span> + str + <span class="stringliteral">"\n"</span> );
<a name="l00082"></a>00082         <span class="keywordflow">throw</span>;
<a name="l00083"></a>00083       }     
<a name="l00084"></a>00084       <span class="keywordflow">catch</span>(  exception&amp; e ) { <span class="keywordflow">throw</span>; }       
<a name="l00085"></a>00085     }
<a name="l00086"></a>00086     <span class="keywordflow">else</span> <span class="keywordflow">if</span>( str.compare( 0, 6, <span class="stringliteral">"Size: "</span>) == 0 )  <span class="comment">//---------------------------------</span>
<a name="l00087"></a>00087     {
<a name="l00088"></a>00088     
<a name="l00089"></a>00089       str.erase(0, 6);
<a name="l00090"></a>00090       stringstream convert(str); <span class="comment">// used to convert string to int</span>
<a name="l00091"></a>00091       <span class="keywordtype">int</span> comboSize = 0;
<a name="l00092"></a>00092       convert &gt;&gt; comboSize;
<a name="l00093"></a>00093       
<a name="l00094"></a>00094       <span class="comment">// Check to see if the value of comboSize is not invalid</span>
<a name="l00095"></a>00095       <span class="keywordflow">if</span>( (i + 1 + comboSize) == description-&gt;size() )
<a name="l00096"></a>00096       {
<a name="l00097"></a>00097       
<a name="l00098"></a>00098         <span class="comment">// TODO Am I generating a memory leak here or is this vector deleted by the destructor ?????????????????????????????????</span>
<a name="l00099"></a>00099         <span class="keywordflow">try</span> { combo = <span class="keyword">new</span> vector&lt;string&gt;; }
<a name="l00100"></a>00100         <span class="keywordflow">catch</span>( exception&amp; e ) { <span class="keywordflow">throw</span>; }
<a name="l00101"></a>00101         
<a name="l00102"></a>00102         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = i+1; j &lt;= (i+comboSize); j++)
<a name="l00103"></a>00103         {
<a name="l00104"></a>00104           str = description-&gt;at(j);
<a name="l00105"></a>00105           <span class="keywordflow">if</span>( str.compare( 0, 8, <span class="stringliteral">"Option: "</span>) == 0 )
<a name="l00106"></a>00106           {
<a name="l00107"></a>00107             str.erase(0, 8);
<a name="l00108"></a>00108             this-&gt;combo-&gt;push_back(str);
<a name="l00109"></a>00109           }
<a name="l00110"></a>00110           <span class="keywordflow">else</span>
<a name="l00111"></a>00111           {
<a name="l00112"></a>00112             <span class="keywordflow">throw</span> <a class="code" href="classFieldException.html" title="A class which defines exceptions which can occur during operations in the field class...">FieldException</a>( 3, this-&gt;<a class="code" href="classComboField.html#82409aa936e0e1a102b2b10bbb8328b2" title="Get function.">getType</a>(), this-&gt;<a class="code" href="classField.html#515aa3274bfaf8cde85a2f6debabfbca" title="A function which returns the field type.">getLabel</a>(), <span class="stringliteral">"Input string was: "</span> + str + <span class="stringliteral">"\n"</span> ); <span class="comment">// throw Error: Not a valid combo object </span>
<a name="l00113"></a>00113           }
<a name="l00114"></a>00114         }
<a name="l00115"></a>00115         i += comboSize;
<a name="l00116"></a>00116       }
<a name="l00117"></a>00117       <span class="keywordflow">else</span>
<a name="l00118"></a>00118       {
<a name="l00119"></a>00119         <span class="keywordflow">throw</span> <a class="code" href="classFieldException.html" title="A class which defines exceptions which can occur during operations in the field class...">FieldException</a>( 5, this-&gt;<a class="code" href="classComboField.html#82409aa936e0e1a102b2b10bbb8328b2" title="Get function.">getType</a>(), this-&gt;<a class="code" href="classField.html#515aa3274bfaf8cde85a2f6debabfbca" title="A function which returns the field type.">getLabel</a>(), <span class="stringliteral">"Input string was: "</span> + str + <span class="stringliteral">"\n"</span> ); <span class="comment">// throw Error: Size of combo field is invalid</span>
<a name="l00120"></a>00120       }
<a name="l00121"></a>00121       
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123     <span class="keywordflow">else</span>  <span class="comment">//-------------------------------------------------------------------</span>
<a name="l00124"></a>00124     {
<a name="l00125"></a>00125       <span class="keywordflow">throw</span> <a class="code" href="classFieldException.html" title="A class which defines exceptions which can occur during operations in the field class...">FieldException</a>( 1, this-&gt;<a class="code" href="classComboField.html#82409aa936e0e1a102b2b10bbb8328b2" title="Get function.">getType</a>(), this-&gt;<a class="code" href="classField.html#515aa3274bfaf8cde85a2f6debabfbca" title="A function which returns the field type.">getLabel</a>(), <span class="stringliteral">"Input string was: "</span> + str + <span class="stringliteral">"\n"</span> ); <span class="comment">// throw Error: unknown item in description </span>
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127     
<a name="l00128"></a>00128   }
<a name="l00129"></a>00129   
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="classComboField.html#2bddbe7a80d5ef045d11613adcf070e9">00135</a> <a class="code" href="classComboField.html#2bddbe7a80d5ef045d11613adcf070e9" title="The destructor.">ComboField::~ComboField</a>()
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 }
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="classComboField.html#82409aa936e0e1a102b2b10bbb8328b2">00144</a> <span class="keywordtype">string</span> <a class="code" href="classComboField.html#82409aa936e0e1a102b2b10bbb8328b2" title="Get function.">ComboField::getType</a>()
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146   <span class="keywordflow">switch</span>(type)
<a name="l00147"></a>00147   {
<a name="l00148"></a>00148     <span class="keywordflow">case</span> 0:
<a name="l00149"></a>00149       <span class="keywordflow">return</span> <span class="stringliteral">"Combo"</span>; 
<a name="l00150"></a>00150     <span class="keywordflow">case</span> 1:
<a name="l00151"></a>00151       <span class="keywordflow">return</span> <span class="stringliteral">"ComboEntry"</span>;
<a name="l00152"></a>00152     <span class="keywordflow">case</span> 2:
<a name="l00153"></a>00153       <span class="keywordflow">return</span> <span class="stringliteral">"ComboRadio"</span>;
<a name="l00154"></a>00154     <span class="keywordflow">default</span>:
<a name="l00155"></a>00155       <span class="keywordflow">return</span> <span class="stringliteral">"UNKNOWN"</span>;
<a name="l00156"></a>00156   }
<a name="l00157"></a>00157 }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="classComboField.html#8453712ded9ca0a5a92082ba33a4da28">00163</a> vector&lt;string&gt; <a class="code" href="classComboField.html#8453712ded9ca0a5a92082ba33a4da28" title="A virtual function to get a full description of the field with all its options.">ComboField::getDescription</a>()
<a name="l00164"></a>00164 {
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="comment">// Create a string vector.</span>
<a name="l00167"></a>00167   vector&lt;string&gt; vec;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169   <span class="comment">// convert int to string via stringstream</span>
<a name="l00170"></a>00170   stringstream convert;
<a name="l00171"></a>00171   <span class="keywordtype">string</span> size;
<a name="l00172"></a>00172   convert &lt;&lt; this-&gt;<a class="code" href="classComboField.html#fa705c223ad9ca038253c7f264c9ab60" title="Get function for the size of the combo vector.">getComboSize</a>();
<a name="l00173"></a>00173   size = convert.str(); 
<a name="l00174"></a>00174 
<a name="l00175"></a>00175   <span class="comment">// Fill in the different lines. </span>
<a name="l00176"></a>00176   vec.push_back( <span class="stringliteral">"Type: "</span>       + this-&gt;<a class="code" href="classComboField.html#82409aa936e0e1a102b2b10bbb8328b2" title="Get function.">getType</a>()   );
<a name="l00177"></a>00177   vec.push_back( <span class="stringliteral">"Label: "</span>      + this-&gt;<a class="code" href="classField.html#515aa3274bfaf8cde85a2f6debabfbca" title="A function which returns the field type.">getLabel</a>()  );
<a name="l00178"></a>00178   vec.push_back( <span class="stringliteral">"Required: "</span>   + this-&gt;<a class="code" href="classField.html#f890923340def2164af1520dcb5c2446" title="A function to convert booleans to strings.">boolToString</a>( this-&gt;<a class="code" href="classField.html#5032f760c77f05a9b4ed82f515b90e59" title="A get function for required.">getRequired</a>() ) ); 
<a name="l00179"></a>00179   vec.push_back( <span class="stringliteral">"Reset: "</span>      + this-&gt;<a class="code" href="classField.html#f890923340def2164af1520dcb5c2446" title="A function to convert booleans to strings.">boolToString</a>( this-&gt;<a class="code" href="classField.html#60e79ba4eddb1ceebc716c8671bbb776" title="A get function for reset.">getReset</a>() )    );
<a name="l00180"></a>00180   vec.push_back( <span class="stringliteral">"Size: "</span>     + size              );
<a name="l00181"></a>00181   <span class="comment">// Iterate over all combo options</span>
<a name="l00182"></a>00182   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="classComboField.html#fa705c223ad9ca038253c7f264c9ab60" title="Get function for the size of the combo vector.">getComboSize</a>(); i++ )
<a name="l00183"></a>00183   {
<a name="l00184"></a>00184     vec.push_back( <span class="stringliteral">"Option: "</span> + this-&gt;<a class="code" href="classComboField.html#649769b624c162cfa916bd2d385c92a2" title="Get function to obtain an element from the combo vector.">getComboElement</a>( i ) );
<a name="l00185"></a>00185   }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187   <span class="comment">// Return the pointer.  </span>
<a name="l00188"></a>00188   <span class="keywordflow">return</span> vec;
<a name="l00189"></a>00189   
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="classComboField.html#fa705c223ad9ca038253c7f264c9ab60">00196</a> <span class="keywordtype">int</span> <a class="code" href="classComboField.html#fa705c223ad9ca038253c7f264c9ab60" title="Get function for the size of the combo vector.">ComboField::getComboSize</a>()
<a name="l00197"></a>00197 {
<a name="l00198"></a>00198   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) combo-&gt;size();
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00204"></a>00204 
<a name="l00205"></a><a class="code" href="classComboField.html#649769b624c162cfa916bd2d385c92a2">00205</a> <span class="keywordtype">string</span> <a class="code" href="classComboField.html#649769b624c162cfa916bd2d385c92a2" title="Get function to obtain an element from the combo vector.">ComboField::getComboElement</a>( <span class="keywordtype">int</span> n )
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207   <span class="keywordflow">if</span>( (n &gt;= 0) &amp;&amp; (n &lt; (<span class="keywordtype">int</span>)combo-&gt;size()) )
<a name="l00208"></a>00208   {
<a name="l00209"></a>00209     <span class="keywordflow">return</span> combo-&gt;at(n);
<a name="l00210"></a>00210   }
<a name="l00211"></a>00211   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Oct 9 17:34:50 2008 for Project by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
